Number.prototype.format=function(){return this.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1 ")},function(a){"use strict";function b(a){return/(10|11|12|13|14|15|16|17|18|19)$/.test(a)?"размеров":/.*1$/.test(a)?"размер":/[2-4]$/.test(a)?"размера":"размеров"}a(function(){var c=0;a(".b-catalog-detail__sizes-item").mouseenter(function(){var b=a(this),c="",d="";b.offset().top-42<a(window).scrollTop()&&(c+=" i-bottom"),d+=' style="margin-left: '+(-75-Math.max(b.offset().left+b.width()/2+75+10-a(document).width(),0))+'px;"',b.append('<div class="b-catalog-detail__popup'+c+'"><div'+d+">В наличии: "+b.data("qty")+" шт.</div></div>")}).mouseleave(function(){a(this).find(".b-catalog-detail__popup").remove()}),setTimeout(function(){a(window).height()>a(".b-catalog-detail__gallery").outerHeight()+20&&a(".b-catalog-detail__gallery").addClass("i-sticky")},2e3),window.matchMedia("(min-width: 1024px)").matches,a(".b-catalog-element-gallery__thumbs-img").click(function(){var b=a(this);b.parent().find(".i-active").removeClass("i-active"),b.addClass("i-active"),a(".b-catalog-element-gallery__main-img").fadeOut(300,function(){a(this).attr("src",b.data("src")).attr("data-large",b.data("large")).fadeIn(300)})});var d=document.querySelectorAll(".b-catalog-detail__prices .b-catalog-detail__price"),e=1*/[\d\s]*/.exec(d[1].textContent)[0].split(" ").join(""),f=1*/[\d\s]*/.exec(d[2].textContent)[0].split(" ").join("");c=f/e;var g=String(d[1].textContent).substring(String(d[1].textContent).search(/[а-яё]*\.?$/));document.querySelectorAll(".b-catalog-detail__basic-prices .b-catalog-detail__price").forEach(function(a){var b=Math.round(1*/[\d\s]*/.exec(a.textContent)[0].split(" ").join("")*c);a.setAttribute("data-action",b)}),document.querySelectorAll(".b-catalog-detail__prices input").forEach(function(a){a.addEventListener("change",function(){var a=this.parentNode.querySelector(".b-catalog-detail__price").getAttribute("data-action");this.closest(".b-catalog-detail__prices").querySelectorAll(".b-catalog-detail__price")[2].textContent=Number(a).format()+" "+g})}),a(".b-catalog-detail__info").each(function(){var c=a(this),d=c.find(".b-catalog-detail__price[data-price=1]"),e=c.find(".b-catalog-detail__price[data-price=2]"),f=c.find(".b-catalog-detail__price[data-price=3]"),g=c.find(".b-catalog-detail__price[data-price=4]"),h=c.find(".b-catalog-detail__order"),i=h.find(".b-catalog-detail__order-num"),j=c.find(".bj-cart-button");c.delegate(".b-catalog-detail__sizes-item:not( .i-disabled )","click",function(){var k=a(this);k.toggleClass("i-active"),k.hasClass("i-active")&&(d.text(k.data("price-1")),e.text(k.data("price-2")),f.text(k.data("price-3")),g.text(k.data("price-4")));var l=c.find(".i-active").length;l?(h.show(),j.removeClass("i-disabled"),i.text(l+" "+b(l))):(d.text(c.data("price-1")),e.text(c.data("price-2")),f.text(c.data("price-3")),g.text(c.data("price-4")),h.hide(),j.addClass("i-disabled"))})}),a(".bj-cart-button").click(function(d){d.preventDefault();var e=a(this),f=(e.data("ajax-url"),{});f.id=[],f.price=a(".b-catalog-detail__prices :radio:checked").val(),f.percentage=c,e.hasClass("i-disabled")||(e.closest(".b-catalog-detail__info").find(".i-active").each(function(){f.id.push(a(this).data("id"))}),a.ajax({url:e.data("ajax-url"),type:e.data("ajax-method"),dataType:"json",data:f,success:function(c){if(c.STATUS&&"OK"===c.STATUS){c.NUM&&a("#bx_cart_num").text(c.NUM);var d=e.closest(".b-catalog-detail__info").find(".i-active").length;a("#cartModalLabelNum").text(d+" "+b(d))}},error:function(a,b,c){window.console&&(console.log(a),console.log(b),console.log(c))}}))}),a(".item-details-accordeon .collapsing-block").not(":first").addClass("closed"),a(".item-details-accordeon .collapsing-block").on("click",".h3",function(){a(this).parent(".collapsing-block").toggleClass("closed")})})}(jQuery);